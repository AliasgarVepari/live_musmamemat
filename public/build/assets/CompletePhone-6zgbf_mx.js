import{n as x,r,j as t,H as j}from"./app-DNu21ahX.js";import{U as S}from"./user-layout-DvYeInNj.js";import{I as c,B as d}from"./input-BXRRwfPK.js";import"./use-forced-theme-CVgMjc0-.js";/* empty css            */import"./index-D5ZxcEdC.js";function N({provider_user_id:p}){const{addToast:i}=x(),[a,h]=r.useState(""),[l,m]=r.useState(""),[u,f]=r.useState("phone"),[o,n]=r.useState(!1),g=async()=>{try{n(!0);const e=await fetch("/api/user/auth/phone/send-otp",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({phone:a,provider_user_id:p})}),s=await e.json();if(!e.ok||!s.success)throw new Error(s.message||"Failed");f("otp"),i({type:"info",title:"OTP Sent",message:"Enter the 6-digit code."})}catch(e){i({type:"error",title:"Error",message:e.message||"Failed to send OTP"})}finally{n(!1)}},y=async()=>{try{n(!0);const e=await fetch("/api/user/auth/phone/verify-otp",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({phone:a,otp:l})}),s=await e.json();if(!e.ok||!s.success)throw new Error(s.message||"Failed");localStorage.setItem("authUser",JSON.stringify(s.data.user)),localStorage.setItem("authToken",s.data.token),window.location.href="/auth/login/"+s.data.token}catch(e){i({type:"error",title:"Error",message:e.message||"Failed to verify OTP"})}finally{n(!1)}};return t.jsxs(S,{children:[t.jsx(j,{title:"Complete Phone"}),t.jsxs("div",{className:"mx-auto w-full max-w-md p-4",children:[t.jsx("h1",{className:"mb-4 text-xl font-semibold",children:"Complete your phone"}),u==="phone"?t.jsxs("div",{className:"space-y-3",children:[t.jsx(c,{placeholder:"Phone (8 digits)",value:a,onChange:e=>h(e.target.value)}),t.jsx(d,{onClick:g,disabled:o||a.length!==8,className:"w-full",children:o?"Sending…":"Send OTP"})]}):t.jsxs("div",{className:"space-y-3",children:[t.jsx(c,{placeholder:"Enter OTP",value:l,onChange:e=>m(e.target.value)}),t.jsx(d,{onClick:y,disabled:o||l.length!==6,className:"w-full",children:o?"Verifying…":"Verify"})]})]})]})}export{N as default};
