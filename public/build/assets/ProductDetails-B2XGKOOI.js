import{d as D,r as c,j as e,c as O,n as le,E as g,X as B}from"./app-uIBbFV7s.js";import{C as d,b as l,c as o,a as m}from"./card-CRPh_RWT.js";import{I as N,B as b,L as oe}from"./Header-CBnxxvlh.js";import{S as R,a as q,b as U,c as G,d as z}from"./select-C4szj2fj.js";import{R as ee,T as me}from"./index-DfaiIYQt.js";import{C as W}from"./check-BKj3NmhL.js";import{P as Y}from"./plus-2LA9Ba3C.js";import{U as he}from"./upload-D-iVhWHy.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xe=[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]],ke=D("House",xe);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pe=[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]],Pe=D("Zap",pe),H=c.forwardRef(({className:t,...h},j)=>e.jsx("textarea",{className:O("flex min-h-[80px] w-full rounded-md border border-brand-red-200 bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-brand-red-600 focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",t),ref:j,...h}));H.displayName="Textarea";const re=c.forwardRef(({className:t,...h},j)=>e.jsx(ee,{className:O("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:border-primary data-[state=unchecked]:bg-white data-[state=unchecked]:border-brand-red-200",t),...h,ref:j,children:e.jsx(me,{className:O("pointer-events-none block h-5 w-5 rounded-full shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=checked]:bg-white data-[state=unchecked]:translate-x-0 data-[state=unchecked]:bg-brand-red-600")})}));re.displayName=ee.displayName;const Ce=({formData:t,updateFormData:h,isSubmitting:j=!1})=>{const{language:s,t:ge}=le(),[se,y]=c.useState(!1),[ue,M]=c.useState(!1),[n,ae]=c.useState({});c.useEffect(()=>{console.log("ProductDetails formData changed:",t)},[t]);const[w,k]=c.useState([]),[P,C]=c.useState([]),[E,V]=c.useState(""),[S,Z]=c.useState(""),[I,J]=c.useState([]),[$,K]=c.useState([]),[A,F]=c.useState([]);c.useEffect(()=>{(async()=>{M(!0);try{const[a,i,u]=await Promise.all([fetch("/api/user/conditions"),fetch("/api/user/governorates"),fetch("/api/user/price-types")]),[x,_,f]=await Promise.all([a.json(),i.json(),u.json()]);J(x.conditions||x||[]),K(_.governorates||_||[]),F(f.priceTypes||f.price_types||f||[])}catch(a){console.error("Error loading data:",a),J([]),K([]),F([])}finally{M(!1)}})()},[]),c.useEffect(()=>{if(t.product_details_en){const r=t.product_details_en.split(`
`).filter(a=>a.trim());k(r)}if(t.product_details_ar){const r=t.product_details_ar.split(`
`).filter(a=>a.trim());C(r)}},[t.product_details_en,t.product_details_ar]);const X=async r=>{if(!r)return;const a=Array.from(r),i=t.images||[];if(i.length+a.length<=10){const x=await Promise.all(a.map(_=>new Promise(f=>{const T=new FileReader;T.onload=()=>f(T.result),T.readAsDataURL(_)})));h({images:[...i,...x]})}},ie=r=>{const i=(t.images||[]).filter((u,x)=>x!==r);h({images:i})},te=r=>{r.preventDefault(),y(!1),X(r.dataTransfer.files)},ne=r=>{r.preventDefault(),y(!0)},ce=r=>{r.preventDefault(),y(!1)},de=(r,a)=>{const i={...n};switch(r){case"title_en":!a||a.trim().length<3?i.title_en=s==="ar"?"العنوان الإنجليزي مطلوب (3 أحرف على الأقل)":"English title is required (minimum 3 characters)":delete i.title_en;break;case"title_ar":!a||a.trim().length<3?i.title_ar=s==="ar"?"العنوان العربي مطلوب (3 أحرف على الأقل)":"Arabic title is required (minimum 3 characters)":delete i.title_ar;break;case"description_en":!a||a.trim().length<10?i.description_en=s==="ar"?"الوصف الإنجليزي مطلوب (10 أحرف على الأقل)":"English description is required (minimum 10 characters)":delete i.description_en;break;case"description_ar":!a||a.trim().length<10?i.description_ar=s==="ar"?"الوصف العربي مطلوب (10 أحرف على الأقل)":"Arabic description is required (minimum 10 characters)":delete i.description_ar;break;case"price":!a||isNaN(Number(a))||Number(a)<0?i.price=s==="ar"?"السعر مطلوب ويجب أن يكون رقم صحيح":"Price is required and must be a valid number":delete i.price;break;case"condition_id":a?delete i.condition_id:i.condition_id=s==="ar"?"حالة المنتج مطلوبة":"Product condition is required";break;case"governorate_id":a?delete i.governorate_id:i.governorate_id=s==="ar"?"الموقع مطلوب":"Location is required";break;case"price_type_id":a?delete i.price_type_id:i.price_type_id=s==="ar"?"نوع السعر مطلوب":"Price type is required";break}ae(i)},p=(r,a)=>{console.log("ProductDetails handleInputChange:",r,a),h({[r]:a}),de(r,a)},v=r=>{const a=r==="en"?E:S;if(a.trim())if(r==="en"){const i=[...w,a.trim()];k(i),V(""),h({product_details_en:i.join(`
`)})}else{const i=[...P,a.trim()];C(i),Z(""),h({product_details_ar:i.join(`
`)})}},Q=(r,a)=>{if(a==="en"){const i=w.filter((u,x)=>x!==r);k(i),h({product_details_en:i.join(`
`)})}else{const i=P.filter((u,x)=>x!==r);C(i),h({product_details_ar:i.join(`
`)})}},L=r=>s==="ar"?r.name_ar:r.name_en;return e.jsxs("div",{className:`space-y-6 ${s==="ar"?"rtl":"ltr"}`,children:[e.jsxs(d,{children:[e.jsx(l,{children:e.jsx(o,{className:s==="ar"?"font-arabic":"",children:s==="ar"?"عنوان المنتج (إنجليزي)":"Product Title (English)"})}),e.jsx(m,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(N,{value:t.title_en||"",onChange:r=>p("title_en",r.target.value),placeholder:s==="ar"?"أدخل عنوان المنتج بالإنجليزية":"Enter product title in English",className:`border-brand-red-200 focus:border-brand-red-600 focus:ring-brand-red-600 ${n.title_en?"border-red-500":""}`}),n.title_en&&e.jsxs("div",{className:"flex items-center gap-2 text-red-500 text-sm",children:[e.jsx(g,{className:"h-4 w-4"}),e.jsx("span",{className:s==="ar"?"font-arabic":"",children:n.title_en})]})]})})]}),e.jsxs(d,{children:[e.jsx(l,{children:e.jsx(o,{className:s==="ar"?"font-arabic":"",children:s==="ar"?"عنوان المنتج (عربي)":"Product Title (Arabic)"})}),e.jsx(m,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(N,{value:t.title_ar||"",onChange:r=>p("title_ar",r.target.value),placeholder:s==="ar"?"أدخل عنوان المنتج بالعربية":"Enter product title in Arabic",className:`border-brand-red-200 focus:border-brand-red-600 focus:ring-brand-red-600 ${n.title_ar?"border-red-500":""}`,dir:"rtl"}),n.title_ar&&e.jsxs("div",{className:"flex items-center gap-2 text-red-500 text-sm",children:[e.jsx(g,{className:"h-4 w-4"}),e.jsx("span",{className:s==="ar"?"font-arabic":"",children:n.title_ar})]})]})})]}),e.jsxs(d,{children:[e.jsx(l,{children:e.jsx(o,{className:s==="ar"?"font-arabic":"",children:s==="ar"?"وصف المنتج (إنجليزي)":"Product Description (English)"})}),e.jsx(m,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(H,{value:t.description_en||"",onChange:r=>p("description_en",r.target.value),placeholder:s==="ar"?"أدخل وصف المنتج بالإنجليزية":"Enter product description in English",className:`border-brand-red-200 focus:border-brand-red-600 focus:ring-brand-red-600 ${n.description_en?"border-red-500":""}`,rows:4}),n.description_en&&e.jsxs("div",{className:"flex items-center gap-2 text-red-500 text-sm",children:[e.jsx(g,{className:"h-4 w-4"}),e.jsx("span",{className:s==="ar"?"font-arabic":"",children:n.description_en})]})]})})]}),e.jsxs(d,{children:[e.jsx(l,{children:e.jsx(o,{className:s==="ar"?"font-arabic":"",children:s==="ar"?"وصف المنتج (عربي)":"Product Description (Arabic)"})}),e.jsx(m,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(H,{value:t.description_ar||"",onChange:r=>p("description_ar",r.target.value),placeholder:s==="ar"?"أدخل وصف المنتج بالعربية":"Enter product description in Arabic",className:`border-brand-red-200 focus:border-brand-red-600 focus:ring-brand-red-600 ${n.description_ar?"border-red-500":""}`,rows:4,dir:"rtl"}),n.description_ar&&e.jsxs("div",{className:"flex items-center gap-2 text-red-500 text-sm",children:[e.jsx(g,{className:"h-4 w-4"}),e.jsx("span",{className:s==="ar"?"font-arabic":"",children:n.description_ar})]})]})})]}),e.jsxs(d,{children:[e.jsx(l,{children:e.jsx(o,{className:s==="ar"?"font-arabic":"",children:s==="ar"?"تفاصيل المنتج (إنجليزي)":"Product Details (English)"})}),e.jsx(m,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"space-y-2",children:w.map((r,a)=>e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-50 rounded-lg",children:[e.jsx(W,{className:"h-5 w-5 text-green-600 flex-shrink-0"}),e.jsx("span",{className:"flex-1 text-sm",children:r}),e.jsx(b,{type:"button",variant:"ghost",size:"sm",onClick:()=>Q(a,"en"),className:"h-8 w-8 p-0 text-red-500 hover:text-red-700 hover:bg-red-50",children:e.jsx(B,{className:"h-4 w-4"})})]},a))}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(N,{value:E,onChange:r=>V(r.target.value),placeholder:s==="ar"?"أدخل تفصيل جديد":"Enter new detail",className:"flex-1 border-brand-red-200 focus:border-brand-red-600 focus:ring-brand-red-600",onKeyPress:r=>r.key==="Enter"&&v("en")}),e.jsx(b,{type:"button",onClick:()=>v("en"),className:"bg-brand-red-600 hover:bg-brand-red-700",disabled:!E.trim(),children:e.jsx(Y,{className:"h-4 w-4"})})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:s==="ar"?"يمكنك إضافة تفاصيل مثل المواصفات، الأبعاد، الماركة، إلخ":"Add details like specifications, dimensions, brand, etc."})]})})]}),e.jsxs(d,{children:[e.jsx(l,{children:e.jsx(o,{className:s==="ar"?"font-arabic":"",children:s==="ar"?"تفاصيل المنتج (عربي)":"Product Details (Arabic)"})}),e.jsx(m,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"space-y-2",children:P.map((r,a)=>e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-50 rounded-lg",children:[e.jsx(W,{className:"h-5 w-5 text-green-600 flex-shrink-0"}),e.jsx("span",{className:`flex-1 text-sm ${s==="ar"?"font-arabic":""}`,children:r}),e.jsx(b,{type:"button",variant:"ghost",size:"sm",onClick:()=>Q(a,"ar"),className:"h-8 w-8 p-0 text-red-500 hover:text-red-700 hover:bg-red-50",children:e.jsx(B,{className:"h-4 w-4"})})]},a))}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(N,{value:S,onChange:r=>Z(r.target.value),placeholder:s==="ar"?"أدخل تفصيل جديد":"Enter new detail",className:"flex-1 border-brand-red-200 focus:border-brand-red-600 focus:ring-brand-red-600",dir:"rtl",onKeyPress:r=>r.key==="Enter"&&v("ar")}),e.jsx(b,{type:"button",onClick:()=>v("ar"),className:"bg-brand-red-600 hover:bg-brand-red-700",disabled:!S.trim(),children:e.jsx(Y,{className:"h-4 w-4"})})]}),e.jsx("p",{className:`text-sm text-muted-foreground ${s==="ar"?"font-arabic":""}`,children:s==="ar"?"يمكنك إضافة تفاصيل مثل المواصفات، الأبعاد، الماركة، إلخ":"Add details like specifications, dimensions, brand, etc."})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs(d,{children:[e.jsx(l,{children:e.jsx(o,{className:s==="ar"?"font-arabic":"",children:s==="ar"?"السعر":"Price"})}),e.jsx(m,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(N,{type:"number",value:t.price||"",onChange:r=>p("price",r.target.value),placeholder:s==="ar"?"أدخل السعر":"Enter price",className:`border-brand-red-200 focus:border-brand-red-600 focus:ring-brand-red-600 ${n.price?"border-red-500":""}`,min:"0",step:"0.01"}),n.price&&e.jsxs("div",{className:"flex items-center gap-2 text-red-500 text-sm",children:[e.jsx(g,{className:"h-4 w-4"}),e.jsx("span",{className:s==="ar"?"font-arabic":"",children:n.price})]})]})})]}),e.jsxs(d,{children:[e.jsx(l,{children:e.jsx(o,{className:s==="ar"?"font-arabic":"",children:s==="ar"?"حالة المنتج":"Product Condition"})}),e.jsx(m,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs(R,{value:t.condition_id?.toString()||"",onValueChange:r=>p("condition_id",parseInt(r)),children:[e.jsx(q,{className:`border-brand-red-200 focus:border-brand-red-600 focus:ring-brand-red-600 ${n.condition_id?"border-red-500":""}`,children:e.jsx(U,{placeholder:s==="ar"?"اختر حالة المنتج":"Select condition"})}),e.jsx(G,{children:I&&I.length>0?I.map(r=>e.jsx(z,{value:r.id.toString(),children:L(r)},r.id)):e.jsx("div",{className:"px-2 py-1.5 text-sm text-muted-foreground",children:s==="ar"?"جاري التحميل...":"Loading..."})})]}),n.condition_id&&e.jsxs("div",{className:"flex items-center gap-2 text-red-500 text-sm",children:[e.jsx(g,{className:"h-4 w-4"}),e.jsx("span",{className:s==="ar"?"font-arabic":"",children:n.condition_id})]})]})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs(d,{children:[e.jsx(l,{children:e.jsx(o,{className:s==="ar"?"font-arabic":"",children:s==="ar"?"الموقع":"Location"})}),e.jsx(m,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs(R,{value:t.governorate_id?.toString()||"",onValueChange:r=>p("governorate_id",parseInt(r)),children:[e.jsx(q,{className:`border-brand-red-200 focus:border-brand-red-600 focus:ring-brand-red-600 ${n.governorate_id?"border-red-500":""}`,children:e.jsx(U,{placeholder:s==="ar"?"اختر الموقع":"Select location"})}),e.jsx(G,{children:$&&$.length>0?$.map(r=>e.jsx(z,{value:r.id.toString(),children:L(r)},r.id)):e.jsx("div",{className:"px-2 py-1.5 text-sm text-muted-foreground",children:s==="ar"?"جاري التحميل...":"Loading..."})})]}),n.governorate_id&&e.jsxs("div",{className:"flex items-center gap-2 text-red-500 text-sm",children:[e.jsx(g,{className:"h-4 w-4"}),e.jsx("span",{className:s==="ar"?"font-arabic":"",children:n.governorate_id})]})]})})]}),e.jsxs(d,{children:[e.jsx(l,{children:e.jsx(o,{className:s==="ar"?"font-arabic":"",children:s==="ar"?"نوع السعر":"Price Type"})}),e.jsx(m,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs(R,{value:t.price_type_id?.toString()||"",onValueChange:r=>p("price_type_id",parseInt(r)),children:[e.jsx(q,{className:`border-brand-red-200 focus:border-brand-red-600 focus:ring-brand-red-600 ${n.price_type_id?"border-red-500":""}`,children:e.jsx(U,{placeholder:s==="ar"?"اختر نوع السعر":"Select price type"})}),e.jsx(G,{children:A&&A.length>0?A.map(r=>e.jsx(z,{value:r.id.toString(),children:L(r)},r.id)):e.jsx("div",{className:"px-2 py-1.5 text-sm text-muted-foreground",children:s==="ar"?"جاري التحميل...":"Loading..."})})]}),n.price_type_id&&e.jsxs("div",{className:"flex items-center gap-2 text-red-500 text-sm",children:[e.jsx(g,{className:"h-4 w-4"}),e.jsx("span",{className:s==="ar"?"font-arabic":"",children:n.price_type_id})]})]})})]})]}),e.jsxs(d,{children:[e.jsx(l,{children:e.jsx(o,{className:s==="ar"?"font-arabic":"",children:s==="ar"?"السعر قابل للتفاوض":"Price Negotiable"})}),e.jsx(m,{children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(re,{id:"negotiable",checked:t.is_negotiable||!1,onCheckedChange:r=>p("is_negotiable",r)}),e.jsx(oe,{htmlFor:"negotiable",className:s==="ar"?"font-arabic":"",children:s==="ar"?"السعر قابل للتفاوض":"Price is negotiable"})]})})]}),e.jsxs(d,{children:[e.jsx(l,{children:e.jsx(o,{className:s==="ar"?"font-arabic":"",children:s==="ar"?"صور المنتج":"Product Images"})}),e.jsxs(m,{children:[e.jsxs("div",{className:`border-2 border-dashed rounded-lg p-8 text-center transition-colors ${se?"border-primary bg-primary/5":!t.images||t.images.length===0?"border-amber-300 bg-amber-50":"border-muted-foreground/25"}`,onDrop:te,onDragOver:ne,onDragLeave:ce,children:[e.jsx(he,{className:`mx-auto h-12 w-12 mb-4 ${!t.images||t.images.length===0?"text-amber-500":"text-muted-foreground"}`}),e.jsx("p",{className:`text-lg font-medium mb-2 ${s==="ar"?"font-arabic":""} ${!t.images||t.images.length===0?"text-amber-700":""}`,children:s==="ar"?"اسحب الصور هنا أو انقر للرفع":"Drag images here or click to upload"}),e.jsx("p",{className:`text-sm text-muted-foreground mb-4 ${s==="ar"?"font-arabic":""}`,children:s==="ar"?"PNG, JPG, GIF حتى 5MB لكل صورة":"PNG, JPG, GIF up to 5MB each"}),e.jsx("input",{type:"file",multiple:!0,accept:".jpeg,.jpg,.png,.gif",onChange:r=>X(r.target.files),className:"hidden",id:"image-upload"}),e.jsx(b,{asChild:!0,children:e.jsx("label",{htmlFor:"image-upload",className:"cursor-pointer",children:s==="ar"?"اختر الصور":"Choose Images"})})]}),(!t.images||t.images.length===0)&&e.jsxs("div",{className:"mt-3 flex items-center gap-2 text-sm text-amber-600",children:[e.jsx(g,{className:"h-4 w-4"}),e.jsx("span",{className:s==="ar"?"font-arabic":"",children:s==="ar"?"يجب رفع صورة واحدة على الأقل":"At least one image is required"})]}),t.images&&t.images.length>0&&e.jsxs("div",{className:"mt-6",children:[e.jsx("h4",{className:`text-sm font-medium mb-3 ${s==="ar"?"font-arabic":""}`,children:s==="ar"?"الصور المرفوعة":"Uploaded Images"}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:t.images.map((r,a)=>{const i=r instanceof File?URL.createObjectURL(r):r;return e.jsxs("div",{className:"relative group",children:[e.jsx("img",{src:i,alt:`Preview ${a+1}`,className:"w-full h-24 object-cover rounded-lg",onError:u=>{u.currentTarget.style.display="none"}}),e.jsx(b,{size:"sm",variant:"destructive",className:"absolute -top-2 -right-2 h-6 w-6 rounded-full p-0 opacity-100 transition-opacity hover:opacity-90",onClick:()=>ie(a),children:e.jsx(B,{className:"h-3 w-3"})})]},a)})})]})]})]}),j&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 flex flex-col items-center gap-4",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"}),e.jsx("p",{className:`text-lg font-medium ${s==="ar"?"font-arabic":""}`,children:s==="ar"?"جاري المعالجة...":"Processing..."}),e.jsx("p",{className:`text-sm text-muted-foreground text-center ${s==="ar"?"font-arabic":""}`,children:s==="ar"?"يرجى الانتظار بينما نقوم بحفظ إعلانك":"Please wait while we save your listing"})]})})]})};export{ke as H,Ce as P,H as T,Pe as Z};
