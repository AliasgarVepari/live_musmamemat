import{c as E,r as p,j as t,e as V,P as O,b as H,q as ze,d as W,g as q,f as Ke,O as qe,ac as L,T as Ve,C as He,a as A,ad as We}from"./app-bcMXV1OJ.js";import{i as Xe,b as Je,B as T,D as Ye,f as Ze,g as Qe,h as et,H as tt,F as rt,o as at,A as st,C as it}from"./Header-C-ywv2p6.js";import{c as se,u as ot,f as nt,I as ct}from"./index-knIJ80NH.js";import{u as lt}from"./index-CL47p2RE.js";import{S as dt}from"./shopping-bag-Cw73_AaU.js";import{H as ie,Z as ut,S as pt,P as ft}from"./SelectUpgradeSubscription-IWuD-Kry.js";import{P as mt}from"./package-CRUvDnVo.js";import{C as oe,a as gt}from"./card-CZlcooGS.js";import{C as ht}from"./check-LnUAIC8J.js";import{S as te}from"./star-k1gbl6KA.js";import{C as xt}from"./crown-BBCGlJuh.js";import{C as bt}from"./credit-card-zVPtuLIH.js";import{E as yt}from"./eye-DjMW3p9_.js";import{P as vt}from"./plus--EKMCy1b.js";import{U as _t}from"./user-layout-CiBx-uDD.js";import{C as jt}from"./chevron-right-B_EbPM8M.js";import"./useQuery-C809mgRE.js";import"./phone-Ca3Quokd.js";import"./index-CqBYegzF.js";import"./index-C2pHj9Xm.js";import"./index-Blrqz472.js";import"./loader-circle-B1iODpe8.js";import"./search-BHnsNXTB.js";import"./user-BkqhVGcy.js";import"./select-CALjZfe6.js";import"./index-DwCqEDoI.js";import"./index-BdQq_4o_.js";import"./index-FiRd6DA3.js";import"./upload-DRjArimN.js";import"./use-forced-theme-D_hGoBMX.js";/* empty css            *//**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nt=[["path",{d:"M9 12h.01",key:"157uk2"}],["path",{d:"M15 12h.01",key:"1k8ypt"}],["path",{d:"M10 16c.5.3 1.2.5 2 .5s1.5-.2 2-.5",key:"1u7htd"}],["path",{d:"M19 6.3a9 9 0 0 1 1.8 3.9 2 2 0 0 1 0 3.6 9 9 0 0 1-17.6 0 2 2 0 0 1 0-3.6A9 9 0 0 1 12 3c2 0 3.5 1.1 3.5 2.5s-.9 2.5-2 2.5c-.8 0-1.5-.4-1.5-1",key:"5yv0yz"}]],St=E("Baby",Nt);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wt=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],kt=E("Circle",wt);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ct=[["line",{x1:"6",x2:"10",y1:"11",y2:"11",key:"1gktln"}],["line",{x1:"8",x2:"8",y1:"9",y2:"13",key:"qnk9ow"}],["line",{x1:"15",x2:"15.01",y1:"12",y2:"12",key:"krot7o"}],["line",{x1:"18",x2:"18.01",y1:"10",y2:"10",key:"1lcuu1"}],["path",{d:"M17.32 5H6.68a4 4 0 0 0-3.978 3.59c-.006.052-.01.101-.017.152C2.604 9.416 2 14.456 2 16a3 3 0 0 0 3 3c1 0 1.5-.5 2-1l1.414-1.414A2 2 0 0 1 9.828 16h4.344a2 2 0 0 1 1.414.586L17 18c.5.5 1 1 2 1a3 3 0 0 0 3-3c0-1.545-.604-6.584-.685-7.258-.007-.05-.011-.1-.017-.151A4 4 0 0 0 17.32 5z",key:"mfqc10"}]],At=E("Gamepad2",Ct);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $t=[["path",{d:"M6 3h12l4 6-10 13L2 9Z",key:"1pcd5k"}],["path",{d:"M11 3 8 9l4 13 4-13-3-6",key:"1fcu3u"}],["path",{d:"M2 9h20",key:"16fsjt"}]],Rt=E("Gem",$t);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Et=[["path",{d:"M17.8 19.2 16 11l3.5-3.5C21 6 21.5 4 21 3c-1-.5-3 0-4.5 1.5L13 8 4.8 6.2c-.5-.1-.9.1-1.1.5l-.3.5c-.2.5-.1 1 .3 1.3L9 12l-2 3H4l-1 1 3 2 2 3 1-1v-3l3-2 3.5 5.3c.3.4.8.5 1.3.3l.5-.2c.4-.3.6-.7.5-1.2z",key:"1v9wt8"}]],Pt=E("Plane",Et);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const It=[["path",{d:"M20.38 3.46 16 2a4 4 0 0 1-8 0L3.62 3.46a2 2 0 0 0-1.34 2.23l.58 3.47a1 1 0 0 0 .99.84H6v10c0 1.1.9 2 2 2h8a2 2 0 0 0 2-2V10h2.15a1 1 0 0 0 .99-.84l.58-3.47a2 2 0 0 0-1.34-2.23z",key:"1wgbhj"}]],Tt=E("Shirt",It);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dt=[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]],Mt=E("Smartphone",Dt);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ft=[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}],["path",{d:"M20 3v4",key:"1olli1"}],["path",{d:"M22 5h-4",key:"1gvqau"}],["path",{d:"M4 17v2",key:"vumght"}],["path",{d:"M5 18H3",key:"zchphs"}]],Ot=E("Sparkles",Ft);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lt=[["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["polyline",{points:"12 10 12 12 13 13",key:"19dquz"}],["path",{d:"m16.13 7.66-.81-4.05a2 2 0 0 0-2-1.61h-2.68a2 2 0 0 0-2 1.61l-.78 4.05",key:"18k57s"}],["path",{d:"m7.88 16.36.8 4a2 2 0 0 0 2 1.61h2.72a2 2 0 0 0 2-1.61l.81-4.05",key:"16ny36"}]],Bt=E("Watch",Lt);var X="Progress",J=100,[Ut,Ur]=V(X),[Gt,zt]=Ut(X),ne=p.forwardRef((s,a)=>{const{__scopeProgress:r,value:i=null,max:o,getValueLabel:c=Kt,...v}=s;(o||o===0)&&!re(o)&&console.error(qt(`${o}`,"Progress"));const h=re(o)?o:J;i!==null&&!ae(i,h)&&console.error(Vt(`${i}`,"Progress"));const x=ae(i,h)?i:null,u=G(x)?c(x,h):void 0;return t.jsx(Gt,{scope:r,value:x,max:h,children:t.jsx(O.div,{"aria-valuemax":h,"aria-valuemin":0,"aria-valuenow":G(x)?x:void 0,"aria-valuetext":u,role:"progressbar","data-state":de(x,h),"data-value":x??void 0,"data-max":h,...v,ref:a})})});ne.displayName=X;var ce="ProgressIndicator",le=p.forwardRef((s,a)=>{const{__scopeProgress:r,...i}=s,o=zt(ce,r);return t.jsx(O.div,{"data-state":de(o.value,o.max),"data-value":o.value??void 0,"data-max":o.max,...i,ref:a})});le.displayName=ce;function Kt(s,a){return`${Math.round(s/a*100)}%`}function de(s,a){return s==null?"indeterminate":s===a?"complete":"loading"}function G(s){return typeof s=="number"}function re(s){return G(s)&&!isNaN(s)&&s>0}function ae(s,a){return G(s)&&!isNaN(s)&&s<=a&&s>=0}function qt(s,a){return`Invalid prop \`max\` of value \`${s}\` supplied to \`${a}\`. Only numbers greater than 0 are valid max values. Defaulting to \`${J}\`.`}function Vt(s,a){return`Invalid prop \`value\` of value \`${s}\` supplied to \`${a}\`. The \`value\` prop must be:
  - a positive number
  - less than the value passed to \`max\` (or ${J} if no \`max\` prop is set)
  - \`null\` or \`undefined\` if the progress is indeterminate.

Defaulting to \`null\`.`}var ue=ne,Ht=le;const pe=p.forwardRef(({className:s,value:a,...r},i)=>t.jsx(ue,{ref:i,className:H("relative h-4 w-full overflow-hidden rounded-full bg-secondary",s),...r,children:t.jsx(Ht,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(a||0)}%)`}})}));pe.displayName=ue.displayName;var Y="Radio",[Wt,fe]=V(Y),[Xt,Jt]=Wt(Y),me=p.forwardRef((s,a)=>{const{__scopeRadio:r,name:i,checked:o=!1,required:c,disabled:v,value:h="on",onCheck:x,form:u,..._}=s,[N,e]=p.useState(null),f=W(a,k=>e(k)),g=p.useRef(!1),w=N?u||!!N.closest("form"):!0;return t.jsxs(Xt,{scope:r,checked:o,disabled:v,children:[t.jsx(O.button,{type:"button",role:"radio","aria-checked":o,"data-state":be(o),"data-disabled":v?"":void 0,disabled:v,value:h,..._,ref:f,onClick:q(s.onClick,k=>{o||x?.(),w&&(g.current=k.isPropagationStopped(),g.current||k.stopPropagation())})}),w&&t.jsx(xe,{control:N,bubbles:!g.current,name:i,value:h,checked:o,required:c,disabled:v,form:u,style:{transform:"translateX(-100%)"}})]})});me.displayName=Y;var ge="RadioIndicator",he=p.forwardRef((s,a)=>{const{__scopeRadio:r,forceMount:i,...o}=s,c=Jt(ge,r);return t.jsx(Ke,{present:i||c.checked,children:t.jsx(O.span,{"data-state":be(c.checked),"data-disabled":c.disabled?"":void 0,...o,ref:a})})});he.displayName=ge;var Yt="RadioBubbleInput",xe=p.forwardRef(({__scopeRadio:s,control:a,checked:r,bubbles:i=!0,...o},c)=>{const v=p.useRef(null),h=W(v,c),x=lt(r),u=qe(a);return p.useEffect(()=>{const _=v.current;if(!_)return;const N=window.HTMLInputElement.prototype,f=Object.getOwnPropertyDescriptor(N,"checked").set;if(x!==r&&f){const g=new Event("click",{bubbles:i});f.call(_,r),_.dispatchEvent(g)}},[x,r,i]),t.jsx(O.input,{type:"radio","aria-hidden":!0,defaultChecked:r,...o,tabIndex:-1,ref:h,style:{...o.style,...u,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});xe.displayName=Yt;function be(s){return s?"checked":"unchecked"}var Zt=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],z="RadioGroup",[Qt,Gr]=V(z,[se,fe]),ye=se(),ve=fe(),[er,tr]=Qt(z),_e=p.forwardRef((s,a)=>{const{__scopeRadioGroup:r,name:i,defaultValue:o,value:c,required:v=!1,disabled:h=!1,orientation:x,dir:u,loop:_=!0,onValueChange:N,...e}=s,f=ye(r),g=ot(u),[w,k]=ze({prop:c,defaultProp:o??null,onChange:N,caller:z});return t.jsx(er,{scope:r,name:i,required:v,disabled:h,value:w,onValueChange:k,children:t.jsx(nt,{asChild:!0,...f,orientation:x,dir:g,loop:_,children:t.jsx(O.div,{role:"radiogroup","aria-required":v,"aria-orientation":x,"data-disabled":h?"":void 0,dir:g,...e,ref:a})})})});_e.displayName=z;var je="RadioGroupItem",Ne=p.forwardRef((s,a)=>{const{__scopeRadioGroup:r,disabled:i,...o}=s,c=tr(je,r),v=c.disabled||i,h=ye(r),x=ve(r),u=p.useRef(null),_=W(a,u),N=c.value===o.value,e=p.useRef(!1);return p.useEffect(()=>{const f=w=>{Zt.includes(w.key)&&(e.current=!0)},g=()=>e.current=!1;return document.addEventListener("keydown",f),document.addEventListener("keyup",g),()=>{document.removeEventListener("keydown",f),document.removeEventListener("keyup",g)}},[]),t.jsx(ct,{asChild:!0,...h,focusable:!v,active:N,children:t.jsx(me,{disabled:v,required:c.required,checked:N,...x,...o,name:c.name,ref:_,onCheck:()=>c.onValueChange(o.value),onKeyDown:q(f=>{f.key==="Enter"&&f.preventDefault()}),onFocus:q(o.onFocus,()=>{e.current&&u.current?.click()})})})});Ne.displayName=je;var rr="RadioGroupIndicator",Se=p.forwardRef((s,a)=>{const{__scopeRadioGroup:r,...i}=s,o=ve(r);return t.jsx(he,{...o,...i,ref:a})});Se.displayName=rr;var we=_e,ke=Ne,ar=Se;const Ce=p.forwardRef(({className:s,...a},r)=>t.jsx(we,{className:H("grid gap-2",s),...a,ref:r}));Ce.displayName=we.displayName;const Ae=p.forwardRef(({className:s,...a},r)=>t.jsx(ke,{ref:r,className:H("aspect-square h-4 w-4 rounded-full border border-primary text-primary ring-offset-background focus:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",s),...a,children:t.jsx(ar,{className:"flex items-center justify-center",children:t.jsx(kt,{className:"h-2.5 w-2.5 fill-current text-current"})})}));Ae.displayName=ke.displayName;const sr=(s,a)=>{const r=s.toLowerCase(),i=a.toLowerCase();return r.includes("handbag")||r.includes("bag")||i.includes("handbag")||i.includes("bag")?dt:r.includes("clothing")||r.includes("clothes")||r.includes("shirt")||i.includes("clothing")||i.includes("clothes")?Tt:r.includes("jewelry")||r.includes("jewellery")||r.includes("gem")||i.includes("jewelry")||i.includes("jewellery")?Rt:r.includes("watch")||r.includes("watches")||i.includes("watch")||i.includes("watches")?Bt:r.includes("beauty")||r.includes("care")||i.includes("beauty")||i.includes("care")?Ot:r.includes("children")||r.includes("baby")||i.includes("children")||i.includes("baby")?St:r.includes("gaming")||r.includes("game")||i.includes("gaming")||i.includes("game")?At:r.includes("phone")||r.includes("mobile")||i.includes("phone")||i.includes("mobile")?Mt:r.includes("travel")||r.includes("plane")||i.includes("travel")||i.includes("plane")?Pt:r.includes("home")||r.includes("garden")||i.includes("home")||i.includes("garden")?ie:mt},ir=({formData:s,updateFormData:a})=>{const{language:r,t:i}=L(),[o,c]=p.useState([]),[v,h]=p.useState(!0);p.useEffect(()=>{(async()=>{try{const N=await(await fetch("/api/user/categories")).json();c(N.categories||N)}catch(_){console.error("Error loading categories:",_)}finally{h(!1)}})()},[]);const x=u=>{a({category_id:parseInt(u)})};return v?t.jsx("div",{className:"flex items-center justify-center py-12",children:t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto mb-4"}),t.jsx("p",{className:r==="ar"?"font-arabic":"",children:r==="ar"?"جاري تحميل الفئات...":"Loading categories..."})]})}):t.jsxs("div",{className:`space-y-6 ${r==="ar"?"rtl":"ltr"}`,children:[t.jsxs("div",{className:"text-center",children:[t.jsx("h3",{className:`text-lg font-semibold mb-2 ${r==="ar"?"font-arabic":""}`,children:r==="ar"?"اختر فئة المنتج":"Select Product Category"}),t.jsx("p",{className:`text-muted-foreground ${r==="ar"?"font-arabic":""}`,children:r==="ar"?"اختر الفئة التي تنتمي إليها منتجك":"Choose the category that best fits your product"})]}),t.jsx(Ce,{value:s.category_id?.toString()||"",onValueChange:x,className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:o.map(u=>{const _=r==="ar"?u.name_ar:u.name_en,N=sr(_,u.slug),e=s.category_id===u.id;return t.jsxs("div",{children:[t.jsx(Ae,{value:u.id.toString(),id:`category-${u.id}`,className:"peer sr-only"}),t.jsxs(Xe,{htmlFor:`category-${u.id}`,onClick:()=>x(u.id.toString()),className:`group flex flex-col items-center justify-center p-6 border-2 rounded-lg cursor-pointer transition-all ${e?"border-primary bg-primary/10 shadow-md":"border-muted-foreground/25 hover:border-primary hover:bg-primary/5"}`,children:[t.jsx("div",{className:`mb-3 p-3 rounded-full transition-all ${e?"bg-primary text-white":"bg-muted/20 text-muted-foreground group-hover:bg-primary group-hover:text-white"}`,children:u.icon_url?t.jsx("img",{src:u.icon_url,alt:_,className:`h-12 w-12 object-contain transition-all ${e?"brightness-0 invert":"group-hover:brightness-0 group-hover:invert"}`}):t.jsx(N,{className:"h-12 w-12"})}),t.jsx("span",{className:`text-sm font-medium text-center ${r==="ar"?"font-arabic":""} ${e?"text-primary":""}`,children:_})]})]},u.id)})})]})},or=({formData:s,updateFormData:a})=>{const{language:r,t:i}=L(),[o,c]=p.useState([]),[v,h]=p.useState(!0);p.useEffect(()=>{(async()=>{try{const g=await(await fetch("/api/user/subscription-plans")).json();c(g.data||g)}catch(f){console.error("Error loading subscription plans:",f)}finally{h(!1)}})()},[]);const x=e=>{a({subscription_plan_id:e})},u=e=>r==="ar"?e.name_ar:e.name_en,_=e=>{const f={free:{en:["Up to 5 images","Basic listing","7 days visibility","Standard support"],ar:["حتى 5 صور","إعلان أساسي","ظهور لمدة 7 أيام","دعم قياسي"]},silver:{en:["Up to 10 images","Featured listing","14 days visibility","Priority support","Analytics dashboard"],ar:["حتى 10 صور","إعلان مميز","ظهور لمدة 14 يوم","دعم أولوي","لوحة تحليلات"]},gold:{en:["Unlimited images","Premium listing","30 days visibility","24/7 support","Advanced analytics","Featured placement"],ar:["صور غير محدودة","إعلان مميز","ظهور لمدة 30 يوم","دعم 24/7","تحليلات متقدمة","موضع مميز"]}},g=u(e).toLowerCase();let w="free";return(g.includes("silver")||g.includes("فضي"))&&(w="silver"),(g.includes("gold")||g.includes("ذهبي"))&&(w="gold"),f[w][r]},N=e=>{const f=u(e).toLowerCase();return f.includes("free")||f.includes("مجاني")?ut:f.includes("silver")||f.includes("فضي")?te:f.includes("gold")||f.includes("ذهبي")?xt:te};return v?t.jsx("div",{className:"flex items-center justify-center py-12",children:t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto mb-4"}),t.jsx("p",{className:r==="ar"?"font-arabic":"",children:r==="ar"?"جاري تحميل خطط الاشتراك...":"Loading subscription plans..."})]})}):t.jsxs("div",{className:`flex flex-col h-full ${r==="ar"?"rtl":"ltr"}`,children:[t.jsx("div",{className:"flex-1 space-y-6",children:t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:o.map(e=>{N(e);const f=s.subscription_plan_id===e.id,g=_(e);return t.jsx(oe,{className:`flex flex-col h-full cursor-pointer transition-all hover:shadow-lg ${f?"ring-2 ring-primary border-primary":"hover:border-primary/50"}`,onClick:()=>x(e.id),children:t.jsxs(gt,{className:"p-6 flex flex-col h-full",children:[t.jsxs("div",{className:"text-center mb-4",children:[t.jsx("h4",{className:`text-lg font-semibold mb-1 ${r==="ar"?"font-arabic":""}`,children:u(e)}),t.jsxs("div",{className:"flex items-center justify-center gap-2 mb-2",children:[t.jsx("span",{className:`text-2xl font-bold ${r==="ar"?"font-arabic":""}`,children:e.price===0?r==="ar"?"مجاني":"Free":`KD ${e.price}`}),e.price>0&&t.jsx("span",{className:`text-sm text-muted-foreground ${r==="ar"?"font-arabic":""}`,children:e.is_lifetime?r==="ar"?"مدى الحياة":"Lifetime":`/${e.months_count} ${r==="ar"?"شهر":"months"}`})]}),e.price>0&&t.jsx(Je,{variant:"secondary",className:"mb-4",children:r==="ar"?"مدفوع":"Paid"})]}),g.length>0&&t.jsx("ul",{className:"space-y-2 flex-1",children:g.map((w,k)=>t.jsxs("li",{className:"flex items-start gap-2",children:[t.jsx(ht,{className:"h-4 w-4 text-green-500 mt-0.5 flex-shrink-0"}),t.jsx("span",{className:`text-sm ${r==="ar"?"font-arabic":""}`,children:w.trim()})]},k))}),t.jsx(T,{className:`w-full mt-4 ${f?"bg-primary text-primary-foreground":"bg-muted text-muted-foreground hover:bg-primary hover:text-primary-foreground"}`,variant:f?"default":"outline",children:f?r==="ar"?"محدد":"Selected":r==="ar"?"اختر هذه الخطة":"Select This Plan"})]})},e.id)})})}),t.jsx("div",{className:"mt-8 text-center",children:t.jsx("p",{className:`text-sm text-muted-foreground ${r==="ar"?"font-arabic":""}`,children:r==="ar"?"يمكنك تغيير خطة الاشتراك في أي وقت من إعدادات الحساب":"You can change your subscription plan anytime from account settings"})})]})},nr=({isOpen:s,onClose:a,onUpgrade:r,onGoHome:i})=>{const{language:o,t:c}=L();return t.jsx(Ye,{open:s,onOpenChange:a,children:t.jsxs(Ze,{className:"sm:max-w-md",children:[t.jsx(Qe,{children:t.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[t.jsx("div",{className:"flex-shrink-0 w-12 h-12 bg-orange-100 rounded-full flex items-center justify-center",children:t.jsx(Ve,{className:"w-6 h-6 text-orange-600"})}),t.jsx("div",{children:t.jsx(et,{className:`text-xl font-semibold text-gray-900 ${o==="ar"?"font-arabic":""}`,children:o==="ar"?"تم استنفاد حد الإعلانات":"Ad Limit Exhausted"})})]})}),t.jsxs("div",{className:"space-y-4",children:[t.jsx("p",{className:`text-gray-600 leading-relaxed ${o==="ar"?"font-arabic text-right":""}`,children:o==="ar"?"لقد وصلت إلى الحد الأقصى من الإعلانات لهذا الشهر. يمكنك المحاولة مرة أخرى الشهر القادم أو ترقية اشتراكك للحصول على المزيد من الإعلانات.":"Your ad limit for this month has been exhausted. You can try adding next month or upgrade your subscription to get more ads."}),t.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 pt-4",children:[t.jsxs(T,{variant:"outline",onClick:i,className:"flex items-center justify-center gap-2 flex-1",children:[t.jsx(ie,{className:"w-4 h-4"}),t.jsx("span",{className:o==="ar"?"font-arabic":"",children:o==="ar"?"إلغاء الإدراج والعودة للرئيسية":"Cancel Listing and Go Home"})]}),t.jsxs(T,{onClick:r,className:"flex items-center justify-center gap-2 flex-1 bg-brand-red-600 hover:bg-brand-red-700",children:[t.jsx(bt,{className:"w-4 h-4"}),t.jsx("span",{className:o==="ar"?"font-arabic":"",children:o==="ar"?"ترقية الاشتراك":"Upgrade Subscription"})]})]})]})]})})},cr=()=>{const{language:s,t:a}=L();return t.jsx("div",{className:`max-w-2xl mx-auto text-center ${s==="ar"?"rtl":"ltr"}`,children:t.jsxs(oe,{className:"p-8 bg-luxury-ivory border-luxury-gold",children:[t.jsx(He,{className:"h-16 w-16 mx-auto mb-6 text-luxury-gold"}),t.jsx("h2",{className:`text-2xl font-bold text-luxury-black mb-4 ${s==="ar"?"font-arabic":"font-serif"}`,children:a("sell.success.title")}),t.jsx("p",{className:`text-luxury-black/80 mb-6 leading-relaxed ${s==="ar"?"font-arabic":""}`,children:a("sell.success.message")}),t.jsxs("div",{className:`bg-luxury-white p-4 rounded-lg mb-6 ${s==="ar"?"text-right":"text-left"}`,children:[t.jsx("h3",{className:`font-semibold text-luxury-black mb-2 ${s==="ar"?"font-arabic":""}`,children:a("sell.success.next-steps")}),t.jsxs("ul",{className:`space-y-1 text-sm text-luxury-black/80 ${s==="ar"?"font-arabic":""}`,children:[t.jsxs("li",{children:["• ",a("sell.success.step1")]}),t.jsxs("li",{children:["• ",a("sell.success.step2")]}),t.jsxs("li",{children:["• ",a("sell.success.step3")]})]})]}),t.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center",children:[t.jsxs(T,{onClick:()=>A.visit("/profile"),className:"bg-luxury-black text-luxury-white hover:bg-luxury-gold hover:text-luxury-black",children:[t.jsx(yt,{className:`h-4 w-4 ${s==="ar"?"ml-2":"mr-2"}`}),t.jsx("span",{className:s==="ar"?"font-arabic":"",children:a("sell.success.view-listings")})]}),t.jsxs(T,{variant:"outline",onClick:()=>{localStorage.removeItem("sell-draft"),A.visit("/sell/category")},className:"border-luxury-black text-luxury-black hover:bg-luxury-black hover:text-luxury-white",children:[t.jsx(vt,{className:`h-4 w-4 ${s==="ar"?"ml-2":"mr-2"}`}),t.jsx("span",{className:s==="ar"?"font-arabic":"",children:a("sell.success.create-another")})]})]})]})})},I=[{id:1,path:"category",titleKey:"sell.step1.title"},{id:2,path:"details",titleKey:"sell.step2.title"},{id:3,path:"subscription",titleKey:"sell.step3.title"},{id:4,path:"submitted",titleKey:"sell.step4.title"}],lr=({step:s="category"})=>{const{language:a,t:r}=L(),{isAuthenticated:i,user:o}=We(),{toast:c}=at(),[v,h]=p.useState(!1),[x,u]=p.useState(!1),[_,N]=p.useState(!1),[e,f]=p.useState(()=>{const l=localStorage.getItem("sell-draft");return l?JSON.parse(l):{}}),[g,w]=p.useState(e.draftAdId||null),[k,$e]=p.useState(null),[K,Z]=p.useState(!1),C=I.find(l=>l.path===s)?.id||1;p.useEffect(()=>{i?Re():h(!0)},[i]),p.useEffect(()=>{Object.keys(e).length>0&&localStorage.setItem("sell-draft",JSON.stringify(e))},[e]);const B=l=>{f(n=>({...n,...l}))},Re=async()=>{if(i)try{const l=localStorage.getItem("authToken");if(!l)return;const n=await fetch("/api/user/subscription",{headers:{Authorization:`Bearer ${l}`,"Content-Type":"application/json"}});if(n.ok){const b=await n.json();b.success&&$e(b.data)}}catch(l){console.error("Error fetching user subscription:",l)}},Ee=async l=>{if(g)try{const n=localStorage.getItem("authToken");if(!n)return;(await fetch(`/api/user/ads/${g}/current-step`,{method:"PATCH",headers:{Authorization:`Bearer ${n}`,"Content-Type":"application/json"},body:JSON.stringify({current_step:l})})).ok||console.error("Failed to update current step")}catch(n){console.error("Error updating current step:",n)}},Pe=async()=>{if(C===2){Z(!0);try{console.log("Creating draft ad...");const l=await Ie();if(console.log("Draft created with ID:",l),!l){console.log("Draft creation failed, stopping navigation");return}const n=k?.is_active&&new Date(k.expires_at)>new Date,b=(k?.usable_ad_for_this_month??0)>0;if(n&&b){await Q(),A.visit("/sell/submitted");return}else if(n&&!b){u(!0);return}}finally{Z(!1)}}if(C<I.length){const l=C+1;await Ee(l);const n=I.find(b=>b.id===l);n&&A.visit(`/sell/${n.path}`)}},Ie=async()=>{try{const l=localStorage.getItem("authToken");if(!l){console.error("No auth token found");return}if(e.draftAdId)return console.log("Updating existing draft ad:",e.draftAdId),w(e.draftAdId),e.draftAdId;const n=new FormData;e.category_id&&n.append("category_id",e.category_id.toString()),e.title_en&&n.append("title_en",e.title_en),e.title_ar&&n.append("title_ar",e.title_ar),e.description_en&&n.append("description_en",e.description_en),e.description_ar&&n.append("description_ar",e.description_ar),e.product_details_en&&n.append("product_details_en",e.product_details_en),e.product_details_ar&&n.append("product_details_ar",e.product_details_ar),e.condition_id&&n.append("condition_id",e.condition_id.toString()),e.governorate_id&&n.append("governorate_id",e.governorate_id.toString()),e.price&&n.append("price",e.price),e.price_type_id&&n.append("price_type_id",e.price_type_id.toString()),e.is_negotiable!==void 0&&n.append("is_negotiable",e.is_negotiable?"1":"0"),e.images&&e.images.forEach((d,y)=>{if(d instanceof File)n.append(`images[${y}]`,d);else if(typeof d=="string")if(d.startsWith("data:image/"))try{const m=atob(d.split(",")[1]),j=d.split(",")[0].split(":")[1].split(";")[0],R=new ArrayBuffer(m.length),$=new Uint8Array(R);for(let P=0;P<m.length;P++)$[P]=m.charCodeAt(P);const D=new Blob([R],{type:j}),M=new File([D],`image_${y}.jpg`,{type:j});n.append(`images[${y}]`,M)}catch(m){console.error("Error converting base64 image:",m)}else d.startsWith("http")&&console.log("Skipping URL image:",d)}),n.append("status","draft");const b=await fetch("/api/user/ads",{method:"POST",headers:{Authorization:`Bearer ${l}`,"X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")||""},body:n}),S=await b.json();if(console.log("Draft creation response:",S),console.log("Response status:",b.status),S.success){const d=S.data.ad.id;return f(y=>({...y,draftAdId:d})),w(d),c({title:"Draft Saved",description:"Your ad has been saved as a draft",variant:"default"}),d}else if(console.log("Error handling triggered:",S),S.errors){const d=Object.values(S.errors).flat();return console.log("Validation errors:",d),c({title:a==="ar"?"خطأ في التحقق":"Validation Error",description:d.join(", "),variant:"destructive"}),!1}else return console.log("General error:",S.message),c({title:a==="ar"?"خطأ":"Error",description:S.message||(a==="ar"?"فشل في حفظ المسودة":"Failed to save draft"),variant:"destructive"}),!1}catch(l){return console.error("Error creating draft ad:",l),c({title:a==="ar"?"خطأ":"Error",description:a==="ar"?"حدث خطأ غير متوقع. يرجى المحاولة مرة أخرى.":"An unexpected error occurred. Please try again.",variant:"destructive"}),!1}return null},Te=()=>{C>1?A.visit(`/sell/${I[C-2].path}`):A.visit("/")},Q=async()=>{try{const l=localStorage.getItem("authToken");if(!l){console.error("No auth token found");return}if(_&&e.subscription_plan_id){await Be();return}const n=k?.is_active&&new Date(k.expires_at)>new Date,b=(k?.usable_ad_for_this_month??0)>0,S=n&&b?"active":"draft";let d,y;if(g)d=await fetch(`/api/user/ads/${g}`,{method:"PUT",headers:{Authorization:`Bearer ${l}`,"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")||""},body:JSON.stringify({status:S,subscription_plan_id:e.subscription_plan_id})}),y=await d.json();else{const m=new FormData;e.category_id&&m.append("category_id",e.category_id.toString()),e.title_en&&m.append("title_en",e.title_en),e.title_ar&&m.append("title_ar",e.title_ar),e.description_en&&m.append("description_en",e.description_en),e.description_ar&&m.append("description_ar",e.description_ar),e.product_details_en&&m.append("product_details_en",e.product_details_en),e.product_details_ar&&m.append("product_details_ar",e.product_details_ar),e.condition_id&&m.append("condition_id",e.condition_id.toString()),e.governorate_id&&m.append("governorate_id",e.governorate_id.toString()),e.price&&m.append("price",e.price),e.price_type_id&&m.append("price_type_id",e.price_type_id.toString()),e.is_negotiable!==void 0&&m.append("is_negotiable",e.is_negotiable?"1":"0"),e.images&&e.images.forEach((j,R)=>{if(j instanceof File)m.append(`images[${R}]`,j);else if(typeof j=="string")if(j.startsWith("data:image/"))try{const $=atob(j.split(",")[1]),D=j.split(",")[0].split(":")[1].split(";")[0],M=new ArrayBuffer($.length),P=new Uint8Array(M);for(let U=0;U<$.length;U++)P[U]=$.charCodeAt(U);const F=new Blob([M],{type:D}),Ge=new File([F],`image_${R}.jpg`,{type:D});m.append(`images[${R}]`,Ge)}catch($){console.error("Error converting base64 image:",$)}else j.startsWith("http")&&console.log("Skipping URL image:",j)}),m.append("status",S),d=await fetch("/api/user/ads",{method:"POST",headers:{Authorization:`Bearer ${l}`,"X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")||""},body:m}),y=await d.json()}if(y.success){if(e.subscription_plan_id&&!e.draftAdId){const j=await(await fetch(`/api/user/ads/${y.data.ad.id}/subscription`,{method:"POST",headers:{Authorization:`Bearer ${l}`,"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")||""},body:JSON.stringify({subscription_plan_id:e.subscription_plan_id})})).json();if(!j.success){c({title:a==="ar"?"خطأ":"Error",description:j.message||(a==="ar"?"فشل في تعيين خطة الاشتراك":"Failed to assign subscription plan"),variant:"destructive"});return}}localStorage.removeItem("sell-draft"),A.visit("/sell/submitted")}else if(y.errors){const m=Object.values(y.errors).flat();c({title:a==="ar"?"خطأ في التحقق":"Validation Error",description:m.join(", "),variant:"destructive"})}else c({title:a==="ar"?"خطأ":"Error",description:y.message||(a==="ar"?"فشل في إرسال الإعلان":"Failed to submit ad"),variant:"destructive"})}catch(l){console.error("Error submitting ad:",l),c({title:a==="ar"?"خطأ":"Error",description:a==="ar"?"حدث خطأ غير متوقع. يرجى المحاولة مرة أخرى.":"An unexpected error occurred. Please try again.",variant:"destructive"})}},De=()=>(()=>{switch(C){case 1:return!!e.category_id;case 2:return!!(e.title_en&&e.title_ar&&e.description_en&&e.description_ar&&e.condition_id&&e.governorate_id&&e.price&&e.price_type_id&&e.images&&e.images.length>0);case 3:return!!e.subscription_plan_id;default:return!1}})(),Me=()=>{switch(C){case 1:return t.jsx(ir,{formData:e,updateFormData:B});case 2:return t.jsx(ft,{formData:e,updateFormData:B,isSubmitting:K});case 3:return _?t.jsx(pt,{formData:e,updateFormData:B}):t.jsx(or,{formData:e,updateFormData:B});case 4:return t.jsx(cr,{});default:return null}},ee=I[C-1],Fe=()=>{h(!1)},Oe=()=>{u(!1),N(!0),A.visit("/sell/subscription")},Le=()=>{u(!1),A.visit("/")},Be=async()=>{try{const l=localStorage.getItem("authToken");if(!l){console.error("No auth token found");return}const b=await(await fetch("/api/user/subscription/upgrade",{method:"POST",headers:{Authorization:`Bearer ${l}`,"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")||""},body:JSON.stringify({subscription_plan_id:e.subscription_plan_id})})).json();b.success?(c({title:a==="ar"?"تم الترقية بنجاح":"Upgrade Successful",description:a==="ar"?`تمت ترقية اشتراكك! حصلت على ${b.data.ad_limit_increase} إعلان إضافي`:`Your subscription has been upgraded! You received ${b.data.ad_limit_increase} extra ads`,variant:"default"}),await Ue("active")):c({title:a==="ar"?"خطأ في الترقية":"Upgrade Error",description:b.message||(a==="ar"?"فشل في ترقية الاشتراك":"Failed to upgrade subscription"),variant:"destructive"})}catch(l){console.error("Error upgrading subscription:",l),c({title:a==="ar"?"خطأ":"Error",description:a==="ar"?"حدث خطأ غير متوقع":"An unexpected error occurred",variant:"destructive"})}},Ue=async l=>{try{const n=localStorage.getItem("authToken");if(!n){console.error("No auth token found");return}let b,S;if(e.draftAdId)b=await fetch(`/api/user/ads/${e.draftAdId}`,{method:"PUT",headers:{Authorization:`Bearer ${n}`,"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")||""},body:JSON.stringify({status:l})}),S=await b.json();else{const d=new FormData;e.category_id&&d.append("category_id",e.category_id.toString()),e.title_en&&d.append("title_en",e.title_en),e.title_ar&&d.append("title_ar",e.title_ar),e.description_en&&d.append("description_en",e.description_en),e.description_ar&&d.append("description_ar",e.description_ar),e.product_details_en&&d.append("product_details_en",e.product_details_en),e.product_details_ar&&d.append("product_details_ar",e.product_details_ar),e.condition_id&&d.append("condition_id",e.condition_id.toString()),e.governorate_id&&d.append("governorate_id",e.governorate_id.toString()),e.price&&d.append("price",e.price),e.price_type_id&&d.append("price_type_id",e.price_type_id.toString()),e.is_negotiable!==void 0&&d.append("is_negotiable",e.is_negotiable?"1":"0"),e.images&&e.images.forEach((y,m)=>{if(y instanceof File)d.append(`images[${m}]`,y);else if(typeof y=="string")if(y.startsWith("data:image/"))try{const j=atob(y.split(",")[1]),R=y.split(",")[0].split(":")[1].split(";")[0],$=new ArrayBuffer(j.length),D=new Uint8Array($);for(let F=0;F<j.length;F++)D[F]=j.charCodeAt(F);const M=new Blob([$],{type:R}),P=new File([M],`image_${m}.jpg`,{type:R});d.append(`images[${m}]`,P)}catch(j){console.error("Error converting base64 image:",j)}else y.startsWith("http")&&console.log("Skipping URL image:",y)}),d.append("status",l),b=await fetch("/api/user/ads",{method:"POST",headers:{Authorization:`Bearer ${n}`,"X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")||""},body:d}),S=await b.json()}if(S.success)localStorage.removeItem("sell-draft"),A.visit("/sell/submitted");else if(S.errors){const d=Object.values(S.errors).flat();c({title:a==="ar"?"خطأ في التحقق":"Validation Error",description:d.join(", "),variant:"destructive"})}else c({title:a==="ar"?"خطأ":"Error",description:S.message||(a==="ar"?"فشل في إرسال الإعلان":"Failed to submit ad"),variant:"destructive"})}catch(n){console.error("Error submitting ad:",n),c({title:a==="ar"?"خطأ":"Error",description:a==="ar"?"حدث خطأ غير متوقع. يرجى المحاولة مرة أخرى.":"An unexpected error occurred. Please try again.",variant:"destructive"})}};return i?t.jsx(_t,{children:t.jsxs("div",{className:`max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8 ${a==="ar"?"rtl":"ltr"}`,children:[t.jsxs("div",{className:"mb-8",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsx("h1",{className:`text-2xl font-bold text-luxury-black ${a==="ar"?"font-arabic":"font-serif"}`,children:r("sell.wizard.title")}),t.jsxs("span",{className:"text-sm text-muted-foreground",children:[r("sell.wizard.step")," ",C," ",r("sell.wizard.of")," ",I.length]})]}),t.jsx(pe,{value:C/I.length*100,className:"mb-4"}),t.jsxs("div",{className:"text-center",children:[t.jsx("h2",{className:`text-xl font-semibold text-luxury-black mb-2 ${a==="ar"?"font-arabic":""}`,children:r(ee.titleKey)}),t.jsx("p",{className:`text-muted-foreground ${a==="ar"?"font-arabic":""}`,children:r(`${ee.titleKey}.subtitle`)})]})]}),t.jsx("div",{className:"mb-8",children:Me()}),C<4&&t.jsxs("div",{className:"flex justify-between items-center pt-6 border-t border-border",children:[t.jsxs(T,{variant:"secondary",onClick:Te,className:"flex items-center gap-2",children:[t.jsx(it,{className:`h-4 w-4 ${a==="ar"?"rotate-180":""}`}),t.jsx("span",{className:a==="ar"?"font-arabic":"",children:r("sell.wizard.back")})]}),t.jsx(T,{onClick:C===3?Q:Pe,disabled:!De()||K,className:"flex items-center gap-2",children:K?t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),t.jsx("span",{className:a==="ar"?"font-arabic":"",children:a==="ar"?"جاري المعالجة...":"Processing..."})]}):t.jsxs(t.Fragment,{children:[t.jsx("span",{className:a==="ar"?"font-arabic":"",children:r(C===3?"sell.wizard.submit":"sell.wizard.continue")}),t.jsx(jt,{className:`h-4 w-4 ${a==="ar"?"rotate-180":""}`})]})})]}),t.jsx(nr,{isOpen:x,onClose:()=>u(!1),onUpgrade:Oe,onGoHome:Le})]})}):t.jsx(st,{isOpen:v,onClose:()=>{h(!1),A.visit("/")},onSuccess:Fe})};function zr({step:s="category"}){return p.useEffect(()=>{(s==="sell"||s==="")&&A.visit("/sell/category",{replace:!0})},[s]),p.useEffect(()=>{if(s==="category"){const a=localStorage.getItem("sell-draft");if(a){const r=JSON.parse(a);if(r.draftAdId){const i=r.current_step||2,c={1:"category",2:"details",3:"subscription",4:"submitted"}[i]||"details";c!=="category"&&A.visit(`/sell/${c}`,{replace:!0})}}}},[s]),t.jsxs("div",{className:"min-h-screen bg-background",children:[t.jsx(tt,{}),t.jsx("main",{className:"py-16",children:t.jsx(lr,{step:s})}),t.jsx(rt,{})]})}export{zr as default};
