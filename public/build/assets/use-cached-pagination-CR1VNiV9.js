import{u as R}from"./useQuery-BX8TA0Nj.js";import{r}from"./app-D4fftTGD.js";const x=({endpoint:n,dataKey:m,initialPage:P=1,initialPerPage:y="20",initialSearch:l="",initialFilters:S={},staleTime:b=120*1e3,gcTime:E=300*1e3})=>{const[a,o]=r.useState({currentPage:P,perPage:y,search:l,filters:S}),[u,k]=r.useState(l),[C,f]=r.useState(!1),q=["admin",n,{...a,search:u}],T=r.useCallback(async()=>{try{f(!0);const e={page:a.currentPage,per_page:a.perPage,...u&&{search:u},...Object.fromEntries(Object.entries(a.filters).filter(([p,s])=>s&&s!=="all"))},t=new URLSearchParams;Object.entries(e).forEach(([p,s])=>{s!=null&&s!==""&&t.append(p,s.toString())});const i=t.toString(),L=`${n}${i?`?${i}`:""}`,g=await fetch(L,{method:"GET",headers:{"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest","J-Json":"true","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")||""}});if(!g.ok)throw new Error(`HTTP error! status: ${g.status}`);const h=await g.json(),d=m||n.split("/").pop();return d?h[d]:h}catch(e){throw console.error("Error fetching paginated data:",e),console.error("Error fetching paginated data:",n),e}finally{f(!1)}},[n,a,u]),c=R({queryKey:q,queryFn:T,staleTime:b,gcTime:E,refetchOnWindowFocus:!1,retry:2}),w=r.useCallback(e=>{o(t=>({...t,currentPage:e}))},[]),F=r.useCallback(e=>{o(t=>({...t,perPage:e,currentPage:1}))},[]),j=r.useCallback(e=>{o(t=>({...t,search:e,currentPage:1}))},[]),O=r.useCallback(e=>{o(t=>({...t,filters:e,currentPage:1}))},[]),D=r.useCallback((e,t)=>{o(i=>({...i,filters:{...i.filters,[e]:t},currentPage:1}))},[]);return r.useEffect(()=>{const e=setTimeout(()=>{k(a.search)},300);return()=>clearTimeout(e)},[a.search]),{data:c.data,isLoading:c.isLoading||C,isError:c.isError,error:c.error,isFetching:c.isFetching,refetch:c.refetch,paginationState:a,goToPage:w,setPerPage:F,setSearch:j,setFilters:O,updateFilter:D}};export{x as u};
